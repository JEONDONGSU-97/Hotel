<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="com.hotel.app.iRoom">
<!-- namespace= "인터페이스의 경로명+이름" -->
   <select id="getRoomList" resultType="com.hotel.app.Roominfo">
<!--    select id = "인터페이스의 메소드" resultType = 인터페이스의 반환 데이터 타입
      select roomcode,name,type,howmany,howmuch from room order by name -->
      select a.roomcode, a.name roomname, b.name typename, a.howmany, a.howmuch, b.typecode
      from room a, roomtype b
      where a.type=b.typecode order by roomname
   </select>
   <select id="getRoomView" resultType="com.hotel.app.Roomview">
     select a.roomcode, b.typecode, a.name roomname, b.name typename, to_char(c.checkin, 'YYYY-MM-DD') checkin, to_char(c.checkout, 'YYYY-MM-DD') checkout, c.person, c.name, c.mobile
	 from room a, roomtype b, booking c
	 where a.type=b.typecode and a.roomcode=c.roomcode
	 order by roomname	
   </select>
   <select id="getRoomType" resultType="com.hotel.app.Roomtype">
      select typecode,name from roomtype order by typecode
   </select>
   <!-- xml에서  sql문 뒤에 ; 붙이면 오류남-->
   <delete id="doDeleteRoom">
      delete from room where roomcode=#{roomcode}
   </delete>
   <insert id="doAddRoom">
   <!-- DB에 적힌 스키마랑 똑같이 요소를 적어줘야 insert가 된다. -->
      insert into room(roomcode,name,type,howmany,howmuch)
      values(seqroom.nextval,#{param1},#{param2},#{param3},#{param4})
   </insert>
   <update id="doUpdateRoom">
      update room set name=#{param2},type=#{param3},howmany=#{param4},howmuch=#{param5}
      where roomcode=#{param1}
   </update>
   <insert id="doSignin">
   	  insert into member(name,loginid,passcode)
   	  values (#{param1},#{param2},#{param3})
   </insert>
   <select id="doCheckUser" resultType="int">
      select count(*) from member where loginid=#{param1} and passcode=#{param2}
   </select>
	<insert id="doAddBooking">
	  insert into booking(bookcode, roomcode, checkin, checkout, person, price, name, mobile)
      values(
         seq_book.nextval,
         #{param1},
         #{param2},
         #{param3},
         #{param4},
         #{param5},
         #{param6},
         #{param7}
      )
	</insert>
</mapper>